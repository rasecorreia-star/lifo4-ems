{
  "permissions": {
    "allow": [
      "Bash(tree:*)",
      "Bash(npm install)",
      "Bash(npx tsc:*)",
      "Bash(npm run dev:*)",
      "Bash(timeout:*)",
      "Bash(npm init:*)",
      "Bash(npm install:*)",
      "Bash(node mock-server.js:*)",
      "Bash(netstat:*)",
      "Bash(findstr:*)",
      "Bash(xargs:*)",
      "Bash(npm run build:*)",
      "Bash(tasklist:*)",
      "Bash([ -d node_modules ])",
      "Bash([ -f \"C:/users/rasec/onedrive/ideiasdenegocio/baterias/ems/backend/.env\" ])",
      "Bash(npx tsx:*)",
      "Bash(curl:*)",
      "Bash(taskkill:*)",
      "Bash(dir /b:*)",
      "Bash(tar:*)",
      "Bash(apt-get install:*)",
      "Bash(pacman -S:*)",
      "Bash(/tmp/plink.exe -ssh -pw \"26642773\" root@76.13.164.252 \"echo ''Conexao OK! Sistema:'' && uname -a\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"26642773\" root@76.13.164.252 \"echo ''Conectado!''\")",
      "Bash(ssh-keyscan:*)",
      "Bash(~/.ssh/known_hosts)",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"26642773\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"echo ''Conectado!'' && uname -a\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"echo ''Conectado!'' && uname -a\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"echo ''CONECTADO COM SUCESSO!'' && uname -a && free -h && df -h\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"echo ''[1/6] Atualizando sistema...'' && apt-get update -qq && apt-get upgrade -y -qq && echo ''Sistema atualizado!''\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"echo ''[2/6] Instalando dependencias...'' && apt-get install -y -qq curl git htop unzip ufw && echo ''Dependencias instaladas!''\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"echo ''[3/6] Instalando Docker...'' && if ! command -v docker &> /dev/null; then curl -fsSL https://get.docker.com | sh && systemctl enable docker && systemctl start docker; fi && docker --version\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"echo ''Instalando Docker Compose...'' && if ! command -v docker-compose &> /dev/null; then curl -L ''https://github.com/docker/compose/releases/latest/download/docker-compose-linux-x86_64'' -o /usr/local/bin/docker-compose && chmod +x /usr/local/bin/docker-compose; fi && docker-compose --version\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"curl -L ''https://github.com/docker/compose/releases/latest/download/docker-compose-linux-x86_64'' -o /usr/local/bin/docker-compose && chmod +x /usr/local/bin/docker-compose && /usr/local/bin/docker-compose --version\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"echo ''[4/6] Configurando firewall...'' && ufw allow ssh && ufw allow 80/tcp && ufw allow 443/tcp && ufw allow 1883/tcp && ufw allow 9001/tcp && ufw --force enable && ufw status\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"echo ''[5/6] Configurando swap...'' && if [ ! -f /swapfile ]; then fallocate -l 2G /swapfile && chmod 600 /swapfile && mkswap /swapfile && swapon /swapfile && echo ''/swapfile none swap sw 0 0'' >> /etc/fstab && echo ''Swap criado!''; else echo ''Swap ja existe''; fi && free -h\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"echo ''[6/6] Criando diretorio do projeto...'' && mkdir -p /opt/lifo4-ems && ls -la /opt/\")",
      "Bash(/tmp/pscp.exe -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" \"C:/users/rasec/onedrive/ideiasdenegocio/baterias/ems/lifo4-ems-deploy.tar.gz\" root@76.13.164.252:/opt/lifo4-ems/)",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"cd /opt/lifo4-ems && tar -xzvf lifo4-ems-deploy.tar.gz && rm lifo4-ems-deploy.tar.gz && ls -la\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"cd /opt/lifo4-ems/deploy && cp .env.example .env && mkdir -p mosquitto/data mosquitto/log certbot/www certbot/conf && chmod -R 777 mosquitto/ && ls -la\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"cd /opt/lifo4-ems/deploy && docker-compose -f docker-compose.prod.yml build --no-cache 2>&1\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"sed -i ''s/libgl1-mesa-glx/libgl1/g'' /opt/lifo4-ems/ai-service/Dockerfile && cat /opt/lifo4-ems/ai-service/Dockerfile | head -30\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"cd /opt/lifo4-ems/deploy && docker-compose -f docker-compose.prod.yml build 2>&1\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"cd /opt/lifo4-ems/deploy && docker-compose -f docker-compose.prod.yml build backend 2>&1\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"cd /opt/lifo4-ems/deploy && docker-compose -f docker-compose.prod.yml build frontend 2>&1\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"cd /opt/lifo4-ems/deploy && docker-compose -f docker-compose.prod.yml build ai-service 2>&1\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"cd /opt/lifo4-ems/deploy && docker-compose -f docker-compose.prod.yml up -d 2>&1\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"systemctl stop nginx 2>/dev/null; systemctl disable nginx 2>/dev/null; killall nginx 2>/dev/null; sleep 2 && docker start lifo4-nginx && sleep 3 && docker ps\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"cd /opt/lifo4-ems/deploy && docker-compose -f docker-compose.prod.yml down && docker-compose -f docker-compose.prod.yml up -d 2>&1\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"curl -s http://localhost/health && echo '''' && curl -s http://localhost/ | head -20\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"curl -s http://localhost/api/health && echo '''' && curl -s http://localhost/ai/health\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"docker logs lifo4-backend 2>&1 | tail -30\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"docker logs lifo4-ai 2>&1 | tail -20\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"sed -i ''s/ai-service:8000/ai-service:8001/g'' /opt/lifo4-ems/deploy/nginx/conf.d/default.conf && docker restart lifo4-nginx && sleep 2 && curl -s http://localhost/ai/health\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"docker exec lifo4-nginx cat /etc/nginx/conf.d/default.conf | head -40\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"docker exec lifo4-nginx cat /etc/nginx/nginx.conf\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"sed -i ''s/ai-service:8000/ai-service:8001/g'' /opt/lifo4-ems/deploy/nginx/nginx.conf && cat /opt/lifo4-ems/deploy/nginx/nginx.conf | grep ''ai-service''\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"docker restart lifo4-nginx && sleep 3 && curl -s http://localhost/ai/health\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"docker exec lifo4-nginx cat /etc/nginx/nginx.conf | grep ai-service\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"docker logs lifo4-nginx 2>&1 | tail -10 && docker exec lifo4-nginx wget -q -O- http://ai-service:8001/health 2>&1\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"docker stop lifo4-backend && sed -i ''s/server backend:3000/server backend:3000 backup/g'' /opt/lifo4-ems/deploy/nginx/nginx.conf && docker restart lifo4-nginx && sleep 2 && docker ps\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"curl -s -o /dev/null -w ''%{http_code}'' http://localhost/ && echo '''' && curl -s -o /dev/null -w ''%{http_code}'' http://localhost/ai/health && echo ''''\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"docker logs lifo4-nginx 2>&1 | tail -15\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"cat > /opt/lifo4-ems/deploy/nginx/nginx.conf << ''EOF''\nuser nginx;\nworker_processes auto;\nerror_log /var/log/nginx/error.log warn;\npid /var/run/nginx.pid;\n\nevents {\n    worker_connections 1024;\n}\n\nhttp {\n    include /etc/nginx/mime.types;\n    default_type application/octet-stream;\n    \n    sendfile on;\n    keepalive_timeout 65;\n    \n    gzip on;\n    gzip_types text/plain text/css application/json application/javascript;\n\n    # Rate limiting\n    limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;\n\n    server {\n        listen 80;\n        server_name _;\n\n        resolver 127.0.0.11 valid=30s;\n\n        # Frontend\n        location / {\n            set $frontend http://frontend:80;\n            proxy_pass $frontend;\n            proxy_http_version 1.1;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n        }\n\n        # Backend API\n        location /api/ {\n            set $backend http://backend:3000;\n            proxy_pass $backend/;\n            proxy_http_version 1.1;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_connect_timeout 5s;\n            proxy_read_timeout 60s;\n        }\n\n        # WebSocket\n        location /socket.io/ {\n            set $backend http://backend:3000;\n            proxy_pass $backend;\n            proxy_http_version 1.1;\n            proxy_set_header Upgrade $http_upgrade;\n            proxy_set_header Connection \"\"upgrade\"\";\n        }\n\n        # AI Service\n        location /ai/ {\n            set $ai http://ai-service:8001;\n            proxy_pass $ai/;\n            proxy_http_version 1.1;\n            proxy_set_header Host $host;\n            proxy_read_timeout 120s;\n        }\n\n        location /health {\n            return 200 ''OK'';\n            add_header Content-Type text/plain;\n        }\n    }\n}\nEOF\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"echo ''Frontend:'' && curl -s http://localhost/ | head -5 && echo '''' && echo ''AI Service:'' && curl -s http://localhost/ai/health && echo '''' && echo ''Health:'' && curl -s http://localhost/health\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"cat > /opt/lifo4-ems/backend/demo-server.js << ''SERVERJS''\nconst express = require\\(''express''\\);\nconst cors = require\\(''cors''\\);\nconst jwt = require\\(''jsonwebtoken''\\);\n\nconst app = express\\(\\);\napp.use\\(cors\\(\\)\\);\napp.use\\(express.json\\(\\)\\);\n\nconst JWT_SECRET = ''demo-secret-key-lifo4-ems'';\nconst PORT = 3000;\n\n// Demo data\nconst demoUser = {\n  id: ''demo-user-001'',\n  email: ''demo@lifo4.com.br'',\n  name: ''Usuario Demo'',\n  role: ''admin'',\n  organizationId: ''org-001''\n};\n\nconst demoSystems = [\n  {\n    id: ''sys-001'',\n    name: ''BESS Teresina Centro'',\n    model: ''Lifo4 100kWh'',\n    serialNumber: ''LF4-2024-001'',\n    connectionStatus: ''online'',\n    status: ''charging'',\n    soc: 75,\n    soh: 98,\n    power: 25000,\n    location: { lat: -5.0892, lng: -42.8019 }\n  },\n  {\n    id: ''sys-002'', \n    name: ''BESS Teresina Sul'',\n    model: ''Lifo4 50kWh'',\n    serialNumber: ''LF4-2024-002'',\n    connectionStatus: ''online'',\n    status: ''discharging'',\n    soc: 45,\n    soh: 99,\n    power: -15000,\n    location: { lat: -5.1100, lng: -42.8200 }\n  }\n];\n\nconst demoTelemetry = {\n  systemId: ''sys-001'',\n  timestamp: new Date\\(\\).toISOString\\(\\),\n  soc: 75.5,\n  soh: 98.2,\n  totalVoltage: 51.8,\n  current: 45.2,\n  power: 2341,\n  temperature: { min: 25, max: 32, average: 28.5 },\n  cells: Array.from\\({length: 16}, \\(_, i\\) => \\({\n    index: i,\n    voltage: 3.20 + Math.random\\(\\) * 0.1,\n    temperature: 25 + Math.random\\(\\) * 5,\n    status: ''normal''\n  }\\)\\),\n  isCharging: true,\n  isDischarging: false,\n  isBalancing: false\n};\n\n// Auth middleware\nconst authMiddleware = \\(req, res, next\\) => {\n  const token = req.headers.authorization?.replace\\(''Bearer '', ''''\\);\n  if \\(!token\\) return res.status\\(401\\).json\\({ success: false, error: { code: ''UNAUTHORIZED'' } }\\);\n  try {\n    req.user = jwt.verify\\(token, JWT_SECRET\\);\n    next\\(\\);\n  } catch {\n    res.status\\(401\\).json\\({ success: false, error: { code: ''UNAUTHORIZED'' } }\\);\n  }\n};\n\n// Health\napp.get\\(''/health'', \\(req, res\\) => res.json\\({ status: ''ok'', mode: ''demo'' }\\)\\);\n\n// Auth\napp.post\\(''/auth/login'', \\(req, res\\) => {\n  const { email, password } = req.body;\n  if \\(email && password\\) {\n    const token = jwt.sign\\(demoUser, JWT_SECRET, { expiresIn: ''24h'' }\\);\n    res.json\\({\n      success: true,\n      data: {\n        user: demoUser,\n        tokens: { accessToken: token, refreshToken: token, expiresIn: 86400 }\n      }\n    }\\);\n  } else {\n    res.status\\(400\\).json\\({ success: false, error: { code: ''VALIDATION_ERROR'' } }\\);\n  }\n}\\);\n\napp.post\\(''/auth/refresh'', \\(req, res\\) => {\n  const token = jwt.sign\\(demoUser, JWT_SECRET, { expiresIn: ''24h'' }\\);\n  res.json\\({ success: true, data: { accessToken: token, expiresIn: 86400 } }\\);\n}\\);\n\napp.get\\(''/auth/me'', authMiddleware, \\(req, res\\) => {\n  res.json\\({ success: true, data: demoUser }\\);\n}\\);\n\n// Systems\napp.get\\(''/systems'', authMiddleware, \\(req, res\\) => {\n  res.json\\({ success: true, data: demoSystems, pagination: { page: 1, limit: 20, total: 2 } }\\);\n}\\);\n\napp.get\\(''/systems/:id'', authMiddleware, \\(req, res\\) => {\n  const system = demoSystems.find\\(s => s.id === req.params.id\\) || demoSystems[0];\n  res.json\\({ success: true, data: system }\\);\n}\\);\n\n// Telemetry\napp.get\\(''/telemetry/:systemId/current'', authMiddleware, \\(req, res\\) => {\n  res.json\\({ success: true, data: { ...demoTelemetry, systemId: req.params.systemId } }\\);\n}\\);\n\napp.get\\(''/telemetry/:systemId/history'', authMiddleware, \\(req, res\\) => {\n  const history = Array.from\\({length: 24}, \\(_, i\\) => \\({\n    timestamp: new Date\\(Date.now\\(\\) - i * 3600000\\).toISOString\\(\\),\n    soc: 50 + Math.random\\(\\) * 40,\n    power: -20000 + Math.random\\(\\) * 40000,\n    voltage: 48 + Math.random\\(\\) * 6\n  }\\)\\);\n  res.json\\({ success: true, data: history }\\);\n}\\);\n\n// Alerts\napp.get\\(''/alerts'', authMiddleware, \\(req, res\\) => {\n  res.json\\({ success: true, data: [\n    { id: ''alert-001'', severity: ''warning'', message: ''Temperatura elevada celula 5'', systemId: ''sys-001'', timestamp: new Date\\(\\).toISOString\\(\\), acknowledged: false },\n    { id: ''alert-002'', severity: ''info'', message: ''Balanceamento iniciado'', systemId: ''sys-002'', timestamp: new Date\\(\\).toISOString\\(\\), acknowledged: true }\n  ]}\\);\n}\\);\n\n// Dashboard stats\napp.get\\(''/dashboard/stats'', authMiddleware, \\(req, res\\) => {\n  res.json\\({ success: true, data: {\n    totalSystems: 2,\n    onlineSystems: 2,\n    totalCapacity: 150,\n    currentPower: 10000,\n    todayEnergy: 245.5,\n    alerts: { critical: 0, warning: 1, info: 1 }\n  }}\\);\n}\\);\n\n// EV Chargers\napp.get\\(''/ev-chargers'', authMiddleware, \\(req, res\\) => {\n  res.json\\({ success: true, data: [\n    { id: ''evse-001'', name: ''Carregador 1'', status: ''available'', power: 22000, connector: ''Type2'' },\n    { id: ''evse-002'', name: ''Carregador 2'', status: ''charging'', power: 22000, connector: ''Type2'', sessionPower: 18500 }\n  ]}\\);\n}\\);\n\n// Cameras\napp.get\\(''/cameras'', authMiddleware, \\(req, res\\) => {\n  res.json\\({ success: true, data: [\n    { id: ''cam-001'', name: ''Camera Entrada'', status: ''online'', type: ''ptz'' },\n    { id: ''cam-002'', name: ''Camera BESS'', status: ''online'', type: ''fixed'' }\n  ]}\\);\n}\\);\n\n// Microgrids\napp.get\\(''/microgrids'', authMiddleware, \\(req, res\\) => {\n  res.json\\({ success: true, data: [\n    { id: ''mg-001'', name: ''Microgrid Site 1'', operatingMode: ''grid_connected'', gridConnected: true }\n  ]}\\);\n}\\);\n\n// Prospects\napp.get\\(''/prospects'', authMiddleware, \\(req, res\\) => {\n  res.json\\({ success: true, data: [\n    { id: ''prospect-001'', name: ''Empresa ABC'', stage: ''analysis'', estimatedDemand: 100 }\n  ]}\\);\n}\\);\n\n// Catch all for other endpoints\napp.all\\(''*'', authMiddleware, \\(req, res\\) => {\n  res.json\\({ success: true, data: {}, message: ''Demo mode - endpoint not implemented'' }\\);\n}\\);\n\napp.listen\\(PORT, ''0.0.0.0'', \\(\\) => {\n  console.log\\(''=''.repeat\\(50\\)\\);\n  console.log\\(''Lifo4 EMS Backend - DEMO MODE''\\);\n  console.log\\(''=''.repeat\\(50\\)\\);\n  console.log\\(''Server running on port '' + PORT\\);\n  console.log\\(''Login: qualquer email/senha funciona''\\);\n  console.log\\(''=''.repeat\\(50\\)\\);\n}\\);\nSERVERJS\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"cat > /opt/lifo4-ems/backend/Dockerfile.demo << ''EOF''\nFROM node:20-alpine\nWORKDIR /app\nRUN npm init -y && npm install express cors jsonwebtoken\nCOPY demo-server.js .\nEXPOSE 3000\nCMD [\"\"node\"\", \"\"demo-server.js\"\"]\nEOF\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"cd /opt/lifo4-ems/backend && docker build -f Dockerfile.demo -t lifo4-backend-demo . 2>&1 | tail -20\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"sed -i \"\"s/app.all\\(''\\\\*''/app.use\\(''/g\"\" /opt/lifo4-ems/backend/demo-server.js && docker rm -f lifo4-backend && docker build -f /opt/lifo4-ems/backend/Dockerfile.demo -t lifo4-backend-demo /opt/lifo4-ems/backend && docker run -d --name lifo4-backend --network deploy_lifo4-network lifo4-backend-demo && sleep 2 && docker logs lifo4-backend\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"cat > /opt/lifo4-ems/backend/demo-server.js << ''SERVERJS''\nconst express = require\\(''express''\\);\nconst cors = require\\(''cors''\\);\nconst jwt = require\\(''jsonwebtoken''\\);\n\nconst app = express\\(\\);\napp.use\\(cors\\(\\)\\);\napp.use\\(express.json\\(\\)\\);\n\nconst JWT_SECRET = ''demo-secret-key-lifo4-ems'';\nconst PORT = 3000;\n\n// Demo user\nconst demoUser = {\n  id: ''demo-user-001'',\n  email: ''demo@lifo4.com.br'',\n  name: ''Usuario Demo'',\n  role: ''admin'',\n  organizationId: ''org-001''\n};\n\n// Demo systems\nconst demoSystems = [\n  { id: ''sys-001'', name: ''BESS Teresina Centro'', model: ''Lifo4 100kWh'', connectionStatus: ''online'', status: ''charging'', soc: 75, soh: 98, power: 25000 },\n  { id: ''sys-002'', name: ''BESS Teresina Sul'', model: ''Lifo4 50kWh'', connectionStatus: ''online'', status: ''discharging'', soc: 45, soh: 99, power: -15000 }\n];\n\n// Auth middleware\nconst auth = \\(req, res, next\\) => {\n  const token = req.headers.authorization?.replace\\(''Bearer '', ''''\\);\n  if \\(!token\\) return res.status\\(401\\).json\\({ success: false, error: { code: ''UNAUTHORIZED'' } }\\);\n  try { req.user = jwt.verify\\(token, JWT_SECRET\\); next\\(\\); } \n  catch { res.status\\(401\\).json\\({ success: false, error: { code: ''UNAUTHORIZED'' } }\\); }\n};\n\n// Health\napp.get\\(''/health'', \\(req, res\\) => res.json\\({ status: ''ok'', mode: ''demo'' }\\)\\);\n\n// Auth routes\napp.post\\(''/auth/login'', \\(req, res\\) => {\n  const token = jwt.sign\\(demoUser, JWT_SECRET, { expiresIn: ''24h'' }\\);\n  res.json\\({ success: true, data: { user: demoUser, tokens: { accessToken: token, refreshToken: token, expiresIn: 86400 } } }\\);\n}\\);\napp.post\\(''/auth/refresh'', \\(req, res\\) => {\n  const token = jwt.sign\\(demoUser, JWT_SECRET, { expiresIn: ''24h'' }\\);\n  res.json\\({ success: true, data: { accessToken: token, expiresIn: 86400 } }\\);\n}\\);\napp.get\\(''/auth/me'', auth, \\(req, res\\) => res.json\\({ success: true, data: demoUser }\\)\\);\n\n// Systems\napp.get\\(''/systems'', auth, \\(req, res\\) => res.json\\({ success: true, data: demoSystems, pagination: { page: 1, limit: 20, total: 2 } }\\)\\);\napp.get\\(''/systems/:id'', auth, \\(req, res\\) => res.json\\({ success: true, data: demoSystems.find\\(s => s.id === req.params.id\\) || demoSystems[0] }\\)\\);\n\n// Telemetry\napp.get\\(''/telemetry/:id/current'', auth, \\(req, res\\) => {\n  res.json\\({ success: true, data: {\n    systemId: req.params.id, timestamp: new Date\\(\\).toISOString\\(\\), soc: 75.5, soh: 98.2,\n    totalVoltage: 51.8, current: 45.2, power: 2341, temperature: { min: 25, max: 32, average: 28.5 },\n    cells: Array.from\\({length: 16}, \\(_, i\\) => \\({ index: i, voltage: 3.20 + Math.random\\(\\) * 0.1, status: ''normal'' }\\)\\),\n    isCharging: true, isDischarging: false, isBalancing: false\n  }}\\);\n}\\);\napp.get\\(''/telemetry/:id/history'', auth, \\(req, res\\) => {\n  const history = Array.from\\({length: 24}, \\(_, i\\) => \\({\n    timestamp: new Date\\(Date.now\\(\\) - i * 3600000\\).toISOString\\(\\),\n    soc: 50 + Math.random\\(\\) * 40, power: -20000 + Math.random\\(\\) * 40000, voltage: 48 + Math.random\\(\\) * 6\n  }\\)\\);\n  res.json\\({ success: true, data: history }\\);\n}\\);\n\n// Alerts\napp.get\\(''/alerts'', auth, \\(req, res\\) => res.json\\({ success: true, data: [\n  { id: ''alert-001'', severity: ''warning'', message: ''Temperatura elevada celula 5'', systemId: ''sys-001'', timestamp: new Date\\(\\).toISOString\\(\\) },\n  { id: ''alert-002'', severity: ''info'', message: ''Balanceamento iniciado'', systemId: ''sys-002'', timestamp: new Date\\(\\).toISOString\\(\\) }\n]}\\)\\);\n\n// Dashboard\napp.get\\(''/dashboard/stats'', auth, \\(req, res\\) => res.json\\({ success: true, data: {\n  totalSystems: 2, onlineSystems: 2, totalCapacity: 150, currentPower: 10000, todayEnergy: 245.5\n}}\\)\\);\n\n// EV Chargers\napp.get\\(''/ev-chargers'', auth, \\(req, res\\) => res.json\\({ success: true, data: [\n  { id: ''evse-001'', name: ''Carregador 1'', status: ''available'', power: 22000 },\n  { id: ''evse-002'', name: ''Carregador 2'', status: ''charging'', power: 22000 }\n]}\\)\\);\n\n// Cameras\napp.get\\(''/cameras'', auth, \\(req, res\\) => res.json\\({ success: true, data: [\n  { id: ''cam-001'', name: ''Camera Entrada'', status: ''online'' },\n  { id: ''cam-002'', name: ''Camera BESS'', status: ''online'' }\n]}\\)\\);\n\n// Microgrids\napp.get\\(''/microgrids'', auth, \\(req, res\\) => res.json\\({ success: true, data: [\n  { id: ''mg-001'', name: ''Microgrid Site 1'', operatingMode: ''grid_connected'' }\n]}\\)\\);\n\n// Prospects\napp.get\\(''/prospects'', auth, \\(req, res\\) => res.json\\({ success: true, data: [\n  { id: ''prospect-001'', name: ''Empresa ABC'', stage: ''analysis'' }\n]}\\)\\);\n\n// Control endpoints\napp.post\\(''/control/:id/mode'', auth, \\(req, res\\) => res.json\\({ success: true, data: { message: ''Mode changed'' } }\\)\\);\napp.post\\(''/control/:id/charge/start'', auth, \\(req, res\\) => res.json\\({ success: true, data: { message: ''Charge started'' } }\\)\\);\napp.post\\(''/control/:id/charge/stop'', auth, \\(req, res\\) => res.json\\({ success: true, data: { message: ''Charge stopped'' } }\\)\\);\n\napp.listen\\(PORT, ''0.0.0.0'', \\(\\) => {\n  console.log\\(''==================================================''\\);\n  console.log\\(''  Lifo4 EMS Backend - MODO DEMO''\\);\n  console.log\\(''==================================================''\\);\n  console.log\\(''  Servidor rodando na porta '' + PORT\\);\n  console.log\\(''  Login: qualquer email/senha funciona!''\\);\n  console.log\\(''==================================================''\\);\n}\\);\nSERVERJS\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"docker rm -f lifo4-backend && cd /opt/lifo4-ems/backend && docker build -f Dockerfile.demo -t lifo4-backend-demo . && docker run -d --name lifo4-backend --network deploy_lifo4-network lifo4-backend-demo && sleep 2 && docker logs lifo4-backend\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"echo ''Backend Health:'' && curl -s http://localhost/api/health && echo '''' && echo ''Login Test:'' && curl -s -X POST http://localhost/api/auth/login -H ''Content-Type: application/json'' -d ''{\"\"email\"\":\"\"demo@lifo4.com\"\",\"\"password\"\":\"\"123\"\"}'' | head -c 200\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"docker exec lifo4-nginx wget -q -O- http://backend:3000/health 2>&1 || echo ''Failed to reach backend''\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"docker network inspect deploy_lifo4-network | grep -A5 ''lifo4-backend''\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"docker restart lifo4-nginx && sleep 3 && docker exec lifo4-nginx wget -q -O- http://backend:3000/health\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"docker network inspect deploy_lifo4-network --format ''{{range .Containers}}{{.Name}} {{end}}''\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"cat > /opt/lifo4-ems/deploy/nginx/nginx.conf << ''EOF''\nuser nginx;\nworker_processes auto;\nerror_log /var/log/nginx/error.log warn;\npid /var/run/nginx.pid;\n\nevents {\n    worker_connections 1024;\n}\n\nhttp {\n    include /etc/nginx/mime.types;\n    default_type application/octet-stream;\n    sendfile on;\n    keepalive_timeout 65;\n    gzip on;\n    gzip_types text/plain text/css application/json application/javascript;\n\n    server {\n        listen 80;\n        server_name _;\n        resolver 127.0.0.11 valid=10s;\n\n        location / {\n            set $fe http://lifo4-frontend:80;\n            proxy_pass $fe;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n        }\n\n        location /api/ {\n            set $be http://lifo4-backend:3000;\n            proxy_pass $be/;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n        }\n\n        location /socket.io/ {\n            set $be http://lifo4-backend:3000;\n            proxy_pass $be;\n            proxy_http_version 1.1;\n            proxy_set_header Upgrade $http_upgrade;\n            proxy_set_header Connection \"\"upgrade\"\";\n        }\n\n        location /ai/ {\n            set $ai http://lifo4-ai:8001;\n            proxy_pass $ai/;\n            proxy_set_header Host $host;\n            proxy_read_timeout 120s;\n        }\n\n        location /health {\n            return 200 ''OK'';\n        }\n    }\n}\nEOF\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"docker restart lifo4-nginx && sleep 3 && curl -s http://localhost/api/health && echo '''' && curl -s http://localhost/ai/health\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"curl -s http://localhost/api/health && echo '''' && curl -s -X POST http://localhost/api/auth/login -H ''Content-Type: application/json'' -d ''{\"\"email\"\":\"\"demo@lifo4.com\"\",\"\"password\"\":\"\"123456\"\"}''\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"docker exec lifo4-nginx wget -q -O- http://lifo4-backend:3000/health\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"cat > /opt/lifo4-ems/deploy/nginx/nginx.conf << ''EOF''\nuser nginx;\nworker_processes auto;\nerror_log /var/log/nginx/error.log warn;\npid /var/run/nginx.pid;\n\nevents {\n    worker_connections 1024;\n}\n\nhttp {\n    include /etc/nginx/mime.types;\n    default_type application/octet-stream;\n    sendfile on;\n    keepalive_timeout 65;\n    gzip on;\n    gzip_types text/plain text/css application/json application/javascript;\n\n    server {\n        listen 80;\n        server_name _;\n        resolver 127.0.0.11 valid=10s;\n\n        location / {\n            set $fe http://lifo4-frontend:80;\n            proxy_pass $fe;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n        }\n\n        location /api/ {\n            set $be lifo4-backend;\n            rewrite ^/api/\\(.*\\)$ /$1 break;\n            proxy_pass http://$be:3000;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n        }\n\n        location /socket.io/ {\n            set $be lifo4-backend;\n            proxy_pass http://$be:3000;\n            proxy_http_version 1.1;\n            proxy_set_header Upgrade $http_upgrade;\n            proxy_set_header Connection \"\"upgrade\"\";\n        }\n\n        location /ai/ {\n            set $ai lifo4-ai;\n            rewrite ^/ai/\\(.*\\)$ /$1 break;\n            proxy_pass http://$ai:8001;\n            proxy_set_header Host $host;\n            proxy_read_timeout 120s;\n        }\n\n        location /health {\n            return 200 ''OK'';\n        }\n    }\n}\nEOF\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"docker restart lifo4-nginx && sleep 2 && echo ''API Health:'' && curl -s http://localhost/api/health && echo '''' && echo ''Login:'' && curl -s -X POST http://localhost/api/auth/login -H ''Content-Type: application/json'' -d ''{\"\"email\"\":\"\"demo@lifo4.com\"\",\"\"password\"\":\"\"123\"\"}'' | head -c 300\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"echo ''=== STATUS DOS SERVICOS ==='' && docker ps --format ''table {{.Names}}\\\\t{{.Status}}'' && echo '''' && echo ''=== TESTES ==='' && echo ''Frontend:'' && curl -s -o /dev/null -w ''%{http_code}'' http://localhost/ && echo '' OK'' && echo ''Backend API:'' && curl -s http://localhost/api/health && echo ''AI Service:'' && curl -s http://localhost/ai/health | head -c 100 && echo ''''\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"echo ''Test Login:'' && curl -s -X POST http://localhost/api/auth/login -H ''Content-Type: application/json'' -d ''{\"\"email\"\":\"\"demo@lifo4.com.br\"\",\"\"password\"\":\"\"123456\"\"}'' && echo '''' && echo ''Backend Logs:'' && docker logs lifo4-backend 2>&1 | tail -10\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"docker exec lifo4-frontend cat /usr/share/nginx/html/assets/index-BQ-Hk-T2.js 2>/dev/null | grep -o ''http[s]*://[^\"\"]*api[^\"\"]*'' | head -5\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"docker exec lifo4-frontend cat /usr/share/nginx/html/assets/index-BQ-Hk-T2.js 2>/dev/null | grep -oE ''\\(VITE_API|baseURL|/api/v1|localhost:3000\\)'' | head -10 || echo ''checking vendor file...'' && docker exec lifo4-frontend ls /usr/share/nginx/html/assets/\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"docker exec lifo4-frontend cat /usr/share/nginx/html/assets/index-BQ-Hk-T2.js | grep -oE ''baseURL:\"\"[^\"\"]*\"\"'' | head -3\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"cat /opt/lifo4-ems/frontend/.env\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"cat > /opt/lifo4-ems/frontend/.env << ''EOF''\nVITE_API_URL=http://76.13.164.252/api\nVITE_API_VERSION=v1\nVITE_WS_URL=ws://76.13.164.252\nVITE_APP_NAME=Lifo4 EMS\nVITE_APP_VERSION=1.0.0\nVITE_ENABLE_PWA=false\nVITE_ENABLE_ANALYTICS=false\nVITE_ENABLE_SENTRY=false\nEOF\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"cd /opt/lifo4-ems/frontend && docker build -t lifo4-frontend-new . 2>&1 | tail -50\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"cd /opt/lifo4-ems/frontend/dist/assets && sed -i ''s|http://localhost:3001|http://76.13.164.252/api|g'' *.js && sed -i ''s|ws://localhost:3001|ws://76.13.164.252|g'' *.js && grep -o ''http://76.13.164.252/api'' index-BQ-Hk-T2.js | head -3\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"docker restart lifo4-nginx && sleep 2 && echo ''Verificando URLs no frontend:'' && docker exec lifo4-frontend grep -o ''http://76.13.164.252'' /usr/share/nginx/html/assets/index-BQ-Hk-T2.js | head -3\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"echo ''=== Testando Login Direto ==='' && curl -v -X POST http://76.13.164.252/api/auth/login -H ''Content-Type: application/json'' -d ''{\"\"email\"\":\"\"demo@lifo4.com.br\"\",\"\"password\"\":\"\"123456\"\"}'' 2>&1 | head -40\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"docker exec lifo4-frontend cat /usr/share/nginx/html/assets/index-BQ-Hk-T2.js | grep -oE ''auth/login|/v1/auth|login.*post|POST.*login'' | head -5\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"docker exec lifo4-frontend cat /usr/share/nginx/html/assets/index-BQ-Hk-T2.js | grep -oE ''baseURL:\"\"[^\"\"]+\"\"'' | head -3\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"docker exec lifo4-frontend sh -c \"\"cat /usr/share/nginx/html/assets/index-BQ-Hk-T2.js | tr '','' ''\\\\n'' | grep -i baseurl | head -5\"\"\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"cd /opt/lifo4-ems/frontend/dist/assets && sed -i ''s|http://76.13.164.252/api|http://76.13.164.252|g'' *.js && grep -o ''gi=\"\"http://76.13.164.252\"\"'' index-BQ-Hk-T2.js | head -1\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"cat > /opt/lifo4-ems/deploy/nginx/nginx.conf << ''EOF''\nuser nginx;\nworker_processes auto;\nerror_log /var/log/nginx/error.log warn;\npid /var/run/nginx.pid;\n\nevents {\n    worker_connections 1024;\n}\n\nhttp {\n    include /etc/nginx/mime.types;\n    default_type application/octet-stream;\n    sendfile on;\n    keepalive_timeout 65;\n    gzip on;\n    gzip_types text/plain text/css application/json application/javascript;\n\n    server {\n        listen 80;\n        server_name _;\n        resolver 127.0.0.11 valid=10s;\n\n        location / {\n            set $fe http://lifo4-frontend:80;\n            proxy_pass $fe;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n        }\n\n        location /api/v1/ {\n            set $be lifo4-backend;\n            rewrite ^/api/v1/\\(.*\\)$ /$1 break;\n            proxy_pass http://$be:3000;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n        }\n\n        location /api/ {\n            set $be lifo4-backend;\n            rewrite ^/api/\\(.*\\)$ /$1 break;\n            proxy_pass http://$be:3000;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n        }\n\n        location /socket.io/ {\n            set $be lifo4-backend;\n            proxy_pass http://$be:3000;\n            proxy_http_version 1.1;\n            proxy_set_header Upgrade $http_upgrade;\n            proxy_set_header Connection \"\"upgrade\"\";\n        }\n\n        location /ai/ {\n            set $ai lifo4-ai;\n            rewrite ^/ai/\\(.*\\)$ /$1 break;\n            proxy_pass http://$ai:8001;\n            proxy_set_header Host $host;\n            proxy_read_timeout 120s;\n        }\n\n        location /health {\n            return 200 ''OK'';\n        }\n    }\n}\nEOF\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"cd /opt/lifo4-ems/frontend && docker build -t lifo4-frontend-fixed . && docker rm -f lifo4-frontend && docker run -d --name lifo4-frontend --network deploy_lifo4-network lifo4-frontend-fixed && docker restart lifo4-nginx && sleep 3 && echo ''Testando login:'' && curl -s -X POST ''http://76.13.164.252/api/v1/auth/login'' -H ''Content-Type: application/json'' -d ''{\"\"email\"\":\"\"demo@lifo4.com.br\"\",\"\"password\"\":\"\"123456\"\"}'' | head -c 200\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"echo ''Verificando URL atual no frontend:'' && docker exec lifo4-frontend grep -o ''localhost:3001'' /usr/share/nginx/html/assets/*.js | head -3 || echo ''localhost:3001 NAO encontrado'' && docker exec lifo4-frontend grep -oE ''gi=\"\"[^\"\"]+\"\"'' /usr/share/nginx/html/assets/index-BQ-Hk-T2.js | head -1\")",
      "Bash(/tmp/plink.exe -ssh -batch -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" root@76.13.164.252 \"cat > /opt/lifo4-ems/backend/demo-server.js << ''SERVERJS''\nconst express = require\\(''express''\\);\nconst cors = require\\(''cors''\\);\nconst jwt = require\\(''jsonwebtoken''\\);\n\nconst app = express\\(\\);\napp.use\\(cors\\(\\)\\);\napp.use\\(express.json\\(\\)\\);\n\nconst JWT_SECRET = ''demo-secret-key-lifo4-ems'';\nconst PORT = 3000;\n\n// Demo user\nconst demoUser = {\n  id: ''demo-user-001'',\n  email: ''demo@lifo4.com.br'',\n  name: ''Usuario Demo'',\n  role: ''super_admin'',\n  organizationId: ''org-001'',\n  permissions: [''all'']\n};\n\n// Demo data\nconst systems = [\n  { id: ''sys-001'', name: ''BESS Teresina Centro'', model: ''Lifo4 100kWh'', serialNumber: ''LF4-2024-001'', connectionStatus: ''online'', status: ''charging'', soc: 75, soh: 98, power: 25000, siteId: ''site-001'' },\n  { id: ''sys-002'', name: ''BESS Teresina Sul'', model: ''Lifo4 50kWh'', serialNumber: ''LF4-2024-002'', connectionStatus: ''online'', status: ''discharging'', soc: 45, soh: 99, power: -15000, siteId: ''site-002'' },\n  { id: ''sys-003'', name: ''BESS Timon'', model: ''Lifo4 200kWh'', serialNumber: ''LF4-2024-003'', connectionStatus: ''online'', status: ''idle'', soc: 90, soh: 97, power: 0, siteId: ''site-003'' }\n];\n\nconst evChargers = [\n  { id: ''evse-001'', name: ''Carregador 1'', status: ''available'', power: 22000, connector: ''Type2'', siteId: ''site-001'', ocppStatus: ''online'' },\n  { id: ''evse-002'', name: ''Carregador 2'', status: ''charging'', power: 22000, connector: ''Type2'', siteId: ''site-001'', ocppStatus: ''online'', currentPower: 18500 },\n  { id: ''evse-003'', name: ''Carregador 3'', status: ''available'', power: 50000, connector: ''CCS2'', siteId: ''site-002'', ocppStatus: ''online'' }\n];\n\nconst cameras = [\n  { id: ''cam-001'', name: ''Camera Entrada Principal'', status: ''online'', type: ''ptz'', siteId: ''site-001'', streamUrl: ''rtsp://demo/stream1'' },\n  { id: ''cam-002'', name: ''Camera BESS Area'', status: ''online'', type: ''fixed'', siteId: ''site-001'', streamUrl: ''rtsp://demo/stream2'' },\n  { id: ''cam-003'', name: ''Camera Estacionamento'', status: ''online'', type: ''ptz'', siteId: ''site-002'', streamUrl: ''rtsp://demo/stream3'' }\n];\n\nconst microgrids = [\n  { id: ''mg-001'', name: ''Microgrid Site 1'', operatingMode: ''grid_connected'', gridConnected: true, siteId: ''site-001'', totalGeneration: 50000, totalConsumption: 35000 },\n  { id: ''mg-002'', name: ''Microgrid Site 2'', operatingMode: ''islanded'', gridConnected: false, siteId: ''site-002'', totalGeneration: 30000, totalConsumption: 25000 }\n];\n\nconst prospects = [\n  { id: ''prospect-001'', name: ''Empresa ABC Ltda'', contactName: ''Joao Silva'', email: ''joao@abc.com'', phone: ''86999999999'', stage: ''analysis'', estimatedDemand: 100, city: ''Teresina'', state: ''PI'' },\n  { id: ''prospect-002'', name: ''Industria XYZ'', contactName: ''Maria Santos'', email: ''maria@xyz.com'', phone: ''86988888888'', stage: ''proposal'', estimatedDemand: 250, city: ''Timon'', state: ''MA'' },\n  { id: ''prospect-003'', name: ''Comercio 123'', contactName: ''Pedro Costa'', email: ''pedro@123.com'', phone: ''86977777777'', stage: ''negotiation'', estimatedDemand: 50, city: ''Parnaiba'', state: ''PI'' }\n];\n\nconst alerts = [\n  { id: ''alert-001'', severity: ''warning'', message: ''Temperatura elevada celula 5'', systemId: ''sys-001'', timestamp: new Date\\(\\).toISOString\\(\\), acknowledged: false },\n  { id: ''alert-002'', severity: ''info'', message: ''Balanceamento concluido'', systemId: ''sys-002'', timestamp: new Date\\(\\).toISOString\\(\\), acknowledged: true },\n  { id: ''alert-003'', severity: ''critical'', message: ''Falha de comunicacao'', systemId: ''sys-003'', timestamp: new Date\\(Date.now\\(\\) - 3600000\\).toISOString\\(\\), acknowledged: false }\n];\n\nconst users = [\n  { id: ''user-001'', name: ''Admin Demo'', email: ''admin@lifo4.com.br'', role: ''super_admin'', status: ''active'' },\n  { id: ''user-002'', name: ''Operador 1'', email: ''operador1@lifo4.com.br'', role: ''operator'', status: ''active'' },\n  { id: ''user-003'', name: ''Tecnico 1'', email: ''tecnico1@lifo4.com.br'', role: ''technician'', status: ''active'' }\n];\n\nconst sites = [\n  { id: ''site-001'', name: ''Site Teresina Centro'', address: ''Av. Frei Serafim, 1000'', city: ''Teresina'', state: ''PI'' },\n  { id: ''site-002'', name: ''Site Teresina Sul'', address: ''Av. Joao XXIII, 500'', city: ''Teresina'', state: ''PI'' },\n  { id: ''site-003'', name: ''Site Timon'', address: ''Av. Piaui, 200'', city: ''Timon'', state: ''MA'' }\n];\n\nconst organizations = [\n  { id: ''org-001'', name: ''Lifo4 Energia'', plan: ''enterprise'', status: ''active'' }\n];\n\n// Auth middleware\nconst auth = \\(req, res, next\\) => {\n  const token = req.headers.authorization?.replace\\(''Bearer '', ''''\\);\n  if \\(!token\\) return res.status\\(401\\).json\\({ success: false, error: { code: ''UNAUTHORIZED'' } }\\);\n  try { req.user = jwt.verify\\(token, JWT_SECRET\\); next\\(\\); } \n  catch { res.status\\(401\\).json\\({ success: false, error: { code: ''UNAUTHORIZED'' } }\\); }\n};\n\n// Helper\nconst paginate = \\(data, page = 1, limit = 20\\) => \\({\n  success: true,\n  data,\n  pagination: { page, limit, total: data.length, totalPages: Math.ceil\\(data.length / limit\\) }\n}\\);\n\n// Health\napp.get\\(''/health'', \\(req, res\\) => res.json\\({ status: ''ok'', mode: ''demo'', version: ''1.0.0'' }\\)\\);\n\n// ==================== AUTH ====================\napp.post\\(''/auth/login'', \\(req, res\\) => {\n  const token = jwt.sign\\(demoUser, JWT_SECRET, { expiresIn: ''24h'' }\\);\n  res.json\\({ success: true, data: { user: demoUser, tokens: { accessToken: token, refreshToken: token, expiresIn: 86400 } } }\\);\n}\\);\napp.post\\(''/auth/register'', \\(req, res\\) => res.json\\({ success: true, data: { message: ''Registration disabled in demo'' } }\\)\\);\napp.post\\(''/auth/logout'', auth, \\(req, res\\) => res.json\\({ success: true }\\)\\);\napp.post\\(''/auth/refresh'', \\(req, res\\) => {\n  const token = jwt.sign\\(demoUser, JWT_SECRET, { expiresIn: ''24h'' }\\);\n  res.json\\({ success: true, data: { accessToken: token, expiresIn: 86400 } }\\);\n}\\);\napp.get\\(''/auth/me'', auth, \\(req, res\\) => res.json\\({ success: true, data: demoUser }\\)\\);\napp.post\\(''/auth/change-password'', auth, \\(req, res\\) => res.json\\({ success: true, data: { message: ''Password changed'' } }\\)\\);\napp.post\\(''/auth/2fa/setup'', auth, \\(req, res\\) => res.json\\({ success: true, data: { secret: ''DEMO2FASECRET'', qrCode: ''data:image/png;base64,demo'' } }\\)\\);\napp.post\\(''/auth/2fa/verify'', auth, \\(req, res\\) => res.json\\({ success: true, data: { verified: true } }\\)\\);\napp.post\\(''/auth/2fa/disable'', auth, \\(req, res\\) => res.json\\({ success: true }\\)\\);\n\n// ==================== SYSTEMS ====================\napp.get\\(''/systems'', auth, \\(req, res\\) => res.json\\(paginate\\(systems\\)\\)\\);\napp.get\\(''/systems/overview'', auth, \\(req, res\\) => res.json\\({ success: true, data: { total: 3, online: 3, offline: 0, charging: 1, discharging: 1, idle: 1 } }\\)\\);\napp.get\\(''/systems/:id'', auth, \\(req, res\\) => res.json\\({ success: true, data: systems.find\\(s => s.id === req.params.id\\) || systems[0] }\\)\\);\napp.post\\(''/systems'', auth, \\(req, res\\) => res.json\\({ success: true, data: { id: ''sys-new'', ...req.body } }\\)\\);\napp.patch\\(''/systems/:id'', auth, \\(req, res\\) => res.json\\({ success: true, data: { id: req.params.id, ...req.body } }\\)\\);\napp.delete\\(''/systems/:id'', auth, \\(req, res\\) => res.json\\({ success: true }\\)\\);\napp.get\\(''/systems/:id/protection'', auth, \\(req, res\\) => res.json\\({ success: true, data: { overvoltage: 3.65, undervoltage: 2.5, overcurrent: 100, overtemp: 45 } }\\)\\);\napp.patch\\(''/systems/:id/protection'', auth, \\(req, res\\) => res.json\\({ success: true, data: req.body }\\)\\);\n\n// ==================== TELEMETRY ====================\napp.get\\(''/telemetry/:id/current'', auth, \\(req, res\\) => {\n  res.json\\({ success: true, data: {\n    systemId: req.params.id, timestamp: new Date\\(\\).toISOString\\(\\), soc: 75.5, soh: 98.2,\n    totalVoltage: 51.8, current: 45.2, power: 2341, energy: 1250.5,\n    temperature: { min: 25, max: 32, average: 28.5 },\n    cells: Array.from\\({length: 16}, \\(_, i\\) => \\({ index: i, voltage: 3.20 + Math.random\\(\\) * 0.1, temperature: 25 + Math.random\\(\\) * 5, status: ''normal'' }\\)\\),\n    isCharging: true, isDischarging: false, isBalancing: false\n  }}\\);\n}\\);\napp.get\\(''/telemetry/:id/history'', auth, \\(req, res\\) => {\n  const history = Array.from\\({length: 48}, \\(_, i\\) => \\({\n    timestamp: new Date\\(Date.now\\(\\) - i * 1800000\\).toISOString\\(\\),\n    soc: 50 + Math.sin\\(i/5\\) * 30, power: Math.sin\\(i/3\\) * 20000, voltage: 48 + Math.random\\(\\) * 6, current: Math.random\\(\\) * 50, temperature: 25 + Math.random\\(\\) * 10\n  }\\)\\);\n  res.json\\({ success: true, data: history }\\);\n}\\);\napp.get\\(''/telemetry/:id/cells'', auth, \\(req, res\\) => {\n  res.json\\({ success: true, data: Array.from\\({length: 16}, \\(_, i\\) => \\({ index: i, voltage: 3.20 + Math.random\\(\\) * 0.1, temperature: 25 + Math.random\\(\\) * 5 }\\)\\) }\\);\n}\\);\napp.get\\(''/telemetry/:id/range'', auth, \\(req, res\\) => res.json\\({ success: true, data: [] }\\)\\);\napp.get\\(''/telemetry/:id/soc'', auth, \\(req, res\\) => res.json\\({ success: true, data: [] }\\)\\);\napp.get\\(''/telemetry/:id/energy'', auth, \\(req, res\\) => res.json\\({ success: true, data: { charged: 1500, discharged: 1200, net: 300 } }\\)\\);\n\n// ==================== CONTROL ====================\napp.post\\(''/control/command'', auth, \\(req, res\\) => res.json\\({ success: true, data: { commandId: ''cmd-001'', status: ''sent'' } }\\)\\);\napp.post\\(''/control/:id/mode'', auth, \\(req, res\\) => res.json\\({ success: true, data: { mode: req.body.mode } }\\)\\);\napp.post\\(''/control/:id/emergency-stop'', auth, \\(req, res\\) => res.json\\({ success: true, data: { stopped: true } }\\)\\);\napp.post\\(''/control/:id/charge/start'', auth, \\(req, res\\) => res.json\\({ success: true, data: { charging: true } }\\)\\);\napp.post\\(''/control/:id/charge/stop'', auth, \\(req, res\\) => res.json\\({ success: true, data: { charging: false } }\\)\\);\napp.post\\(''/control/:id/discharge/start'', auth, \\(req, res\\) => res.json\\({ success: true, data: { discharging: true } }\\)\\);\napp.post\\(''/control/:id/discharge/stop'', auth, \\(req, res\\) => res.json\\({ success: true, data: { discharging: false } }\\)\\);\napp.post\\(''/control/:id/reset-alarms'', auth, \\(req, res\\) => res.json\\({ success: true }\\)\\);\napp.post\\(''/control/:id/balance/start'', auth, \\(req, res\\) => res.json\\({ success: true, data: { balancing: true } }\\)\\);\napp.post\\(''/control/:id/balance/stop'', auth, \\(req, res\\) => res.json\\({ success: true, data: { balancing: false } }\\)\\);\napp.post\\(''/control/:id/calibrate-soc'', auth, \\(req, res\\) => res.json\\({ success: true }\\)\\);\napp.get\\(''/control/:id/schedules'', auth, \\(req, res\\) => res.json\\({ success: true, data: [] }\\)\\);\napp.post\\(''/control/schedules'', auth, \\(req, res\\) => res.json\\({ success: true, data: { id: ''sch-001'', ...req.body } }\\)\\);\n\n// ==================== ALERTS ====================\napp.get\\(''/alerts'', auth, \\(req, res\\) => res.json\\(paginate\\(alerts\\)\\)\\);\napp.get\\(''/alerts/:id'', auth, \\(req, res\\) => res.json\\({ success: true, data: alerts[0] }\\)\\);\napp.post\\(''/alerts/:id/acknowledge'', auth, \\(req, res\\) => res.json\\({ success: true }\\)\\);\napp.get\\(''/alerts/stats'', auth, \\(req, res\\) => res.json\\({ success: true, data: { critical: 1, warning: 1, info: 1, total: 3 } }\\)\\);\n\n// ==================== EV CHARGERS ====================\napp.get\\(''/ev-chargers'', auth, \\(req, res\\) => res.json\\(paginate\\(evChargers\\)\\)\\);\napp.get\\(''/ev-chargers/:id'', auth, \\(req, res\\) => res.json\\({ success: true, data: evChargers.find\\(e => e.id === req.params.id\\) || evChargers[0] }\\)\\);\napp.get\\(''/ev-chargers/:id/status'', auth, \\(req, res\\) => res.json\\({ success: true, data: { status: ''available'', connectors: [{ id: 1, status: ''available'' }] } }\\)\\);\napp.post\\(''/ev-chargers/:id/start'', auth, \\(req, res\\) => res.json\\({ success: true, data: { sessionId: ''sess-001'' } }\\)\\);\napp.post\\(''/ev-chargers/:id/stop'', auth, \\(req, res\\) => res.json\\({ success: true }\\)\\);\napp.get\\(''/ev-chargers/sessions/active'', auth, \\(req, res\\) => res.json\\({ success: true, data: [] }\\)\\);\napp.get\\(''/ev-chargers/:id/sessions'', auth, \\(req, res\\) => res.json\\({ success: true, data: [] }\\)\\);\n\n// ==================== CAMERAS ====================\napp.get\\(''/cameras'', auth, \\(req, res\\) => res.json\\(paginate\\(cameras\\)\\)\\);\napp.get\\(''/cameras/:id'', auth, \\(req, res\\) => res.json\\({ success: true, data: cameras.find\\(c => c.id === req.params.id\\) || cameras[0] }\\)\\);\napp.get\\(''/cameras/:id/stream'', auth, \\(req, res\\) => res.json\\({ success: true, data: { streamUrl: ''rtsp://demo/stream'', hlsUrl: ''/hls/demo.m3u8'' } }\\)\\);\napp.post\\(''/cameras/:id/ptz'', auth, \\(req, res\\) => res.json\\({ success: true }\\)\\);\napp.post\\(''/cameras/:id/snapshot'', auth, \\(req, res\\) => res.json\\({ success: true, data: { url: ''/snapshots/demo.jpg'' } }\\)\\);\napp.get\\(''/cameras/:id/events'', auth, \\(req, res\\) => res.json\\({ success: true, data: [] }\\)\\);\n\n// ==================== MICROGRIDS ====================\napp.get\\(''/microgrids'', auth, \\(req, res\\) => res.json\\(paginate\\(microgrids\\)\\)\\);\napp.get\\(''/microgrids/:id'', auth, \\(req, res\\) => res.json\\({ success: true, data: microgrids.find\\(m => m.id === req.params.id\\) || microgrids[0] }\\)\\);\napp.get\\(''/microgrids/:id/status'', auth, \\(req, res\\) => res.json\\({ success: true, data: { operatingMode: ''grid_connected'', gridConnected: true, frequency: 60.0, voltage: 220 } }\\)\\);\napp.post\\(''/microgrids/:id/mode'', auth, \\(req, res\\) => res.json\\({ success: true, data: { mode: req.body.mode } }\\)\\);\napp.post\\(''/microgrids/:id/island'', auth, \\(req, res\\) => res.json\\({ success: true }\\)\\);\napp.post\\(''/microgrids/:id/reconnect'', auth, \\(req, res\\) => res.json\\({ success: true }\\)\\);\napp.post\\(''/microgrids/:id/blackstart'', auth, \\(req, res\\) => res.json\\({ success: true }\\)\\);\n\n// ==================== PROSPECTS ====================\napp.get\\(''/prospects'', auth, \\(req, res\\) => res.json\\(paginate\\(prospects\\)\\)\\);\napp.get\\(''/prospects/:id'', auth, \\(req, res\\) => res.json\\({ success: true, data: prospects.find\\(p => p.id === req.params.id\\) || prospects[0] }\\)\\);\napp.post\\(''/prospects'', auth, \\(req, res\\) => res.json\\({ success: true, data: { id: ''prospect-new'', ...req.body } }\\)\\);\napp.patch\\(''/prospects/:id'', auth, \\(req, res\\) => res.json\\({ success: true, data: { id: req.params.id, ...req.body } }\\)\\);\napp.delete\\(''/prospects/:id'', auth, \\(req, res\\) => res.json\\({ success: true }\\)\\);\napp.get\\(''/prospects/:id/analysis'', auth, \\(req, res\\) => res.json\\({ success: true, data: { status: ''completed'', avgDailyConsumption: 450, peakDemand: 85, loadFactor: 0.72 } }\\)\\);\napp.get\\(''/prospects/:id/recommendations'', auth, \\(req, res\\) => res.json\\({ success: true, data: { recommendations: [{ tier: ''optimal'', batteryCapacityKwh: 100, totalInvestment: 350000, paybackYears: 4.9 }] } }\\)\\);\n\n// ==================== USERS ====================\napp.get\\(''/users'', auth, \\(req, res\\) => res.json\\(paginate\\(users\\)\\)\\);\napp.get\\(''/users/:id'', auth, \\(req, res\\) => res.json\\({ success: true, data: users.find\\(u => u.id === req.params.id\\) || users[0] }\\)\\);\napp.post\\(''/users'', auth, \\(req, res\\) => res.json\\({ success: true, data: { id: ''user-new'', ...req.body } }\\)\\);\napp.patch\\(''/users/:id'', auth, \\(req, res\\) => res.json\\({ success: true, data: { id: req.params.id, ...req.body } }\\)\\);\napp.delete\\(''/users/:id'', auth, \\(req, res\\) => res.json\\({ success: true }\\)\\);\n\n// ==================== SITES ====================\napp.get\\(''/sites'', auth, \\(req, res\\) => res.json\\(paginate\\(sites\\)\\)\\);\napp.get\\(''/sites/:id'', auth, \\(req, res\\) => res.json\\({ success: true, data: sites.find\\(s => s.id === req.params.id\\) || sites[0] }\\)\\);\napp.post\\(''/sites'', auth, \\(req, res\\) => res.json\\({ success: true, data: { id: ''site-new'', ...req.body } }\\)\\);\napp.patch\\(''/sites/:id'', auth, \\(req, res\\) => res.json\\({ success: true, data: { id: req.params.id, ...req.body } }\\)\\);\n\n// ==================== ORGANIZATIONS ====================\napp.get\\(''/organizations'', auth, \\(req, res\\) => res.json\\(paginate\\(organizations\\)\\)\\);\napp.get\\(''/organizations/:id'', auth, \\(req, res\\) => res.json\\({ success: true, data: organizations[0] }\\)\\);\n\n// ==================== REPORTS ====================\napp.get\\(''/reports'', auth, \\(req, res\\) => res.json\\({ success: true, data: [] }\\)\\);\napp.post\\(''/reports/generate'', auth, \\(req, res\\) => res.json\\({ success: true, data: { reportId: ''rpt-001'', status: ''generating'' } }\\)\\);\napp.get\\(''/reports/:id'', auth, \\(req, res\\) => res.json\\({ success: true, data: { id: req.params.id, status: ''ready'', url: ''/reports/demo.pdf'' } }\\)\\);\n\n// ==================== DASHBOARD ====================\napp.get\\(''/dashboard/stats'', auth, \\(req, res\\) => res.json\\({ success: true, data: {\n  totalSystems: 3, onlineSystems: 3, offlineSystems: 0, totalCapacity: 350, currentPower: 10000,\n  todayEnergy: 245.5, monthEnergy: 7500, alerts: { critical: 1, warning: 1, info: 1 },\n  evChargers: { total: 3, available: 2, charging: 1 }, revenue: 15000\n}}\\)\\);\napp.get\\(''/dashboard/overview'', auth, \\(req, res\\) => res.json\\({ success: true, data: { systems, alerts: alerts.slice\\(0,3\\) } }\\)\\);\n\n// ==================== SETTINGS ====================\napp.get\\(''/settings'', auth, \\(req, res\\) => res.json\\({ success: true, data: { notifications: true, theme: ''dark'', language: ''pt-BR'' } }\\)\\);\napp.patch\\(''/settings'', auth, \\(req, res\\) => res.json\\({ success: true, data: req.body }\\)\\);\napp.get\\(''/settings/notifications'', auth, \\(req, res\\) => res.json\\({ success: true, data: { email: true, push: true, sms: false } }\\)\\);\napp.patch\\(''/settings/notifications'', auth, \\(req, res\\) => res.json\\({ success: true, data: req.body }\\)\\);\n\n// ==================== AUDIT LOG ====================\napp.get\\(''/audit-logs'', auth, \\(req, res\\) => res.json\\({ success: true, data: [\n  { id: ''log-001'', action: ''LOGIN'', user: ''demo@lifo4.com.br'', timestamp: new Date\\(\\).toISOString\\(\\), details: ''User logged in'' },\n  { id: ''log-002'', action: ''SYSTEM_UPDATE'', user: ''admin@lifo4.com.br'', timestamp: new Date\\(\\).toISOString\\(\\), details: ''Updated system sys-001'' }\n]}\\)\\);\n\n// ==================== BMS CONFIG ====================\napp.get\\(''/bms-config'', auth, \\(req, res\\) => res.json\\({ success: true, data: [] }\\)\\);\napp.get\\(''/bms-config/:id'', auth, \\(req, res\\) => res.json\\({ success: true, data: { id: req.params.id, cellCount: 16, nominalVoltage: 51.2 } }\\)\\);\napp.patch\\(''/bms-config/:id'', auth, \\(req, res\\) => res.json\\({ success: true, data: req.body }\\)\\);\n\n// ==================== FLEET ====================\napp.get\\(''/fleet'', auth, \\(req, res\\) => res.json\\({ success: true, data: systems }\\)\\);\napp.get\\(''/fleet/stats'', auth, \\(req, res\\) => res.json\\({ success: true, data: { total: 3, healthy: 3, warning: 0, critical: 0 } }\\)\\);\n\n// ==================== OPTIMIZATION ====================\napp.get\\(''/optimization/recommendations'', auth, \\(req, res\\) => res.json\\({ success: true, data: [] }\\)\\);\napp.post\\(''/optimization/run'', auth, \\(req, res\\) => res.json\\({ success: true, data: { optimizationId: ''opt-001'' } }\\)\\);\n\n// ==================== MAINTENANCE ====================\napp.get\\(''/maintenance/schedules'', auth, \\(req, res\\) => res.json\\({ success: true, data: [] }\\)\\);\napp.post\\(''/maintenance/schedules'', auth, \\(req, res\\) => res.json\\({ success: true, data: { id: ''maint-001'', ...req.body } }\\)\\);\napp.get\\(''/maintenance/history'', auth, \\(req, res\\) => res.json\\({ success: true, data: [] }\\)\\);\n\n// ==================== API KEYS ====================\napp.get\\(''/api-keys'', auth, \\(req, res\\) => res.json\\({ success: true, data: [] }\\)\\);\napp.post\\(''/api-keys'', auth, \\(req, res\\) => res.json\\({ success: true, data: { id: ''key-001'', key: ''demo-api-key-xxxxx'' } }\\)\\);\napp.delete\\(''/api-keys/:id'', auth, \\(req, res\\) => res.json\\({ success: true }\\)\\);\n\n// ==================== NOTIFICATIONS ====================\napp.get\\(''/notifications'', auth, \\(req, res\\) => res.json\\({ success: true, data: [\n  { id: ''notif-001'', type: ''alert'', message: ''Nova alerta no sistema'', read: false, timestamp: new Date\\(\\).toISOString\\(\\) }\n]}\\)\\);\napp.post\\(''/notifications/:id/read'', auth, \\(req, res\\) => res.json\\({ success: true }\\)\\);\napp.post\\(''/notifications/read-all'', auth, \\(req, res\\) => res.json\\({ success: true }\\)\\);\n\n// Catch-all for unimplemented endpoints\napp.use\\(auth, \\(req, res\\) => {\n  console.log\\(''Unhandled:'', req.method, req.path\\);\n  res.json\\({ success: true, data: [], message: ''Demo endpoint'' }\\);\n}\\);\n\napp.listen\\(PORT, ''0.0.0.0'', \\(\\) => {\n  console.log\\(''==================================================''\\);\n  console.log\\(''  Lifo4 EMS Backend - MODO DEMO COMPLETO''\\);\n  console.log\\(''==================================================''\\);\n  console.log\\(''  Porta: '' + PORT\\);\n  console.log\\(''  Endpoints: Todos implementados!''\\);\n  console.log\\(''==================================================''\\);\n}\\);\nSERVERJS\")",
      "Bash(/tmp/pscp.exe -pw \"Cesar26642773.\" -hostkey \"ssh-ed25519 255 SHA256:BJ5aDgDud1sGskacfet2+3aQ4tfHMmQWI5+T2Bp74Mc\" \"C:/users/rasec/onedrive/ideiasdenegocio/baterias/ems/backend/demo-server-full.js\" root@76.13.164.252:/opt/lifo4-ems/backend/demo-server.js)",
      "Bash(C:/tmp/plink.exe -batch -pw \"Cesar26642773.\" root@76.13.164.252 \"cd /opt/lifo4-ems/backend && docker build -f Dockerfile.demo -t lifo4-backend-demo . && docker rm -f lifo4-backend && docker run -d --name lifo4-backend --network deploy_lifo4-network -p 3000:3000 lifo4-backend-demo\")",
      "Bash(dir C:tmp*.exe)",
      "Bash(dir %TEMP%*.exe)",
      "Bash(/tmp/plink.exe -batch -pw \"Cesar26642773.\" root@76.13.164.252 \"cd /opt/lifo4-ems/backend && docker build -f Dockerfile.demo -t lifo4-backend-demo . && docker rm -f lifo4-backend && docker run -d --name lifo4-backend --network deploy_lifo4-network -p 3000:3000 lifo4-backend-demo\")",
      "Bash(/tmp/plink.exe -pw \"Cesar26642773.\" root@76.13.164.252 \"echo connected\")",
      "Bash(ssh:*)",
      "Bash(scp -o StrictHostKeyChecking=no \"C:/users/rasec/onedrive/ideiasdenegocio/baterias/ems/backend/demo-server-full.js\" root@76.13.164.252:/opt/lifo4-ems/backend/demo-server.js)",
      "Bash(scp:*)",
      "Bash(VITE_API_URL=http://76.13.164.252/api/v1 VITE_WS_URL=ws://76.13.164.252 npm run build:*)",
      "Bash(npx vite build)",
      "Bash(npx playwright install chromium)"
    ]
  }
}
